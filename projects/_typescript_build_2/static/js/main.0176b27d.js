!function(){"use strict";var t={d:function(e,i){for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{assembleChunk:function(){return S},collided:function(){return M},cosSin:function(){return I},distance:function(){return j},getAngle:function(){return L},getRectSides:function(){return T},getRectsAngle:function(){return Y},getRotation:function(){return X},intersect:function(){return O},lineRectCol:function(){return R},pointRectCol:function(){return C}});var i={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n(e)?e:String(e)}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o(n.key),n)}}function r(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function f(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function d(t){var e=f();return function(){var i,o=c(t);if(e){var s=c(this).constructor;i=Reflect.construct(o,arguments,s)}else i=o.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}(this,i)}}t.r(i),t.d(i,{DmgVfx:function(){return F},ParticlesVfx:function(){return U},SpriteVfx:function(){return H},TextVfx:function(){return J}});var y=new Image;y.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAAXNSR0IArs4c6QAAAjVJREFUeJzt3D9uE0EUwOFZREdLRZUqBQUdFRJcgAvQ5RxUrjhEKlMQLsAFQKJKR0GRKhWVjxAJqll5/8zujOWnyOb7uiix5OKn57ez66QEAMCxdaVfvLm8/Lv/88+7u+LfwthsLOOoMnFRaxJKKapMXNR48thvgPMkLEIIixCWd0I4bgAAAAAAgGOqOnl36k6r6nuF4qJF04N+4qKWx2YIISxC2LEI4aoQAAAAAPhvLR58+tIqh6r+JnQmLmo0/e+GTFys8XQDIYRFCGERwvJOCMcNAABwIorL+IuPbweL+59PPyzuVJvEMg5qTGDUGESyFlUmLtb0gdRGlYmLJV1K7VFl4qLEvUJCdIdOq8zUYo6JRQhhEUJYhHBVSIjmiXV9s0vXN7uI98IZaTogHQf1/v63icWsfmL5WOOYmm9C56llWrHEYzPA6ShOoefbV4OJtbv6ZWJRbRLLOKgxgVFjEMlaVJm4WNMHUhtVJi6WuFdIiC6l9mmVmVqUmFiEEBYhhEUIV4WE6CfWdvOQtpuHx3wvnJEupZS+XbwcTKurzdPFF5lWrGnesURFjT6SPLXyc1ZuQgMAHGywN+3vWR++vx7sWF/f3dqxqDZZ3rMvn5/NvkBg1Gg+bhhPMpjTh7X/da7StIJafUytk8hHIks83UAIYRFCWIQY7Em1e5b9ijUmFiEmk2dtaplW1ChG4pYOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwav4Bf+a83EC/hQwAAAAASUVORK5CYII=";var v=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a(this,t),this.x=void 0,this.y=void 0,this.w=void 0,this.h=void 0,this.sheet=y,this.animation="idle",this.animations={},this.display=!0,this.left=0,this.frame=0,this.frameCounter=0,this.removed=!1,this.rot=0,this.x=e,this.y=i,this.w=n,this.h=o}return r(t,[{key:"loadAnimation",value:function(t){return this.animation!==t&&(this.frameCounter=0,this.frame=0,this.animation=t,!0)}},{key:"onAnimationEnd",value:function(){}},{key:"renderHitbox",value:function(t,e,i,n){}},{key:"renderItem",value:function(t,e,i,n,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;i.drawImage(this.sheet,this.animations.idle.keyframesX[0][0]*n,this.animations.idle.keyframesY[0][0]*n,this.animations.idle.w*n,this.animations.idle.h*n,t*n*o,e*n*o,s*n*o,r*n*o)}},{key:"updateSprite",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.frameCounter+=t,this.frameCounter>=this.animations[this.animation].slowness&&(this.frame++,this.frameCounter=0),this.frame>=this.animations[this.animation].keyframesX[this.left].length&&(this.frame=0,this.frameCounter=0,this.onAnimationEnd())}},{key:"setAnimation",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.animations[t]||(this.animations[t]=new m(this)),n?(this.animations[t].keyframesX[1]=e,this.animations[t].keyframesY[1]=i):(this.animations[t].keyframesX[0]=e,this.animations[t].keyframesY[0]=i,this.animations[t].keyframesX[1]=e,this.animations[t].keyframesY[1]=i)}},{key:"renderSprite",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:this.w/2,y:this.h/2};this.display&&(this.removed,this.rot?(t.save(),t.translate((this.x+this.animations[this.animation].offsetX+o.x+n.x)*e*i|0,(this.y+this.animations[this.animation].offsetY+o.y+n.y)*e*i|0),t.rotate(this.rot),t.drawImage(this.sheet,this.animations[this.animation].keyframesX[this.left][this.frame]*e,this.animations[this.animation].keyframesY[this.left][this.frame]*e,this.animations[this.animation].w*e,this.animations[this.animation].h*e,-o.x*e*i|0,-o.y*e*i|0,this.animations[this.animation].w*e*i|0,this.animations[this.animation].h*e*i|0),t.restore()):t.drawImage(this.sheet,this.animations[this.animation].keyframesX[this.left][this.frame]*e,this.animations[this.animation].keyframesY[this.left][this.frame]*e,this.animations[this.animation].w*e,this.animations[this.animation].h*e,(this.x+this.animations[this.animation].offsetX+n.x)*e*i|0,(this.y+this.animations[this.animation].offsetY+n.y)*e*i|0,this.animations[this.animation].w*e*i|0,this.animations[this.animation].h*e*i|0))}},{key:"renderSquare",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:this.w/2,y:this.h/2};this.display&&(this.removed&&console.log("rendering a removed entity!!!"),this.rot?(t.save(),t.translate((this.x+o.x+n.x)*e*i|0,(this.y+o.y+n.y)*e*i|0),t.rotate(this.rot),t.fillRect(-o.x*e*i|0,-o.y*e*i|0,this.w*e*i|0,this.h*e*i|0),t.restore()):(console.log("rendering player",(this.x+n.x)*e*i|0,(this.y+n.y)*e*i|0,this.w*e*i|0,this.h*e*i|0),t.fillRect((this.x+n.x)*e*i|0,(this.y+n.y)*e*i|0,this.w*e*i|0,this.h*e*i|0)))}}]),t}(),m=r((function t(e){a(this,t),this.keyframesX=void 0,this.keyframesY=void 0,this.slowness=void 0,this.w=void 0,this.h=void 0,this.offsetX=void 0,this.offsetY=void 0,this.keyframesX=[[],[]],this.keyframesY=[[],[]],this.slowness=6,this.w=e.w,this.h=e.h,this.offsetX=(e.w-this.w)/2,this.offsetY=(e.h-this.h)/2}));function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function p(t,e){if(t){if("string"===typeof t)return x(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?x(t,e):void 0}}function w(t,e){var i="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=p(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function b(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!t.solid)return!1;if(function(t,e){var i,n=w(e);try{for(n.s();!(i=n.n()).done;){var o=i.value;if(!A(t,o)&&V(t,o)){if(t.onCollision&&t.onCollision(o),o.onCollision&&o.onCollision(t),E(t,o))continue;P(t,o)}}}catch(s){n.e(s)}finally{n.f()}}(t,e),t.xVel+t.xVelExt!==0||t.yVel+t.yVelExt!==0){for(var n=t.xVel+t.xVelExt,o=t.yVel+t.yVelExt,s=t.hitbox?t.hitbox:t,r={x:n>0?s.x:s.x+n*i,y:o>0?s.y:s.y+o*i,w:n>0?s.w+n*i:s.w-n*i,h:o>0?s.h+o*i:s.h-o*i},a=[],h={value:0},l={x:0,y:0},u={x:0,y:0},c=0;c<e.length;c++){var f=e[c];if(!A(t,f))if(V(r,f))if(k(s,f.hitbox?f.hitbox:f,n,o,i,l,u,h)){if(t.onCollision&&t.onCollision(f,e),E(t,f))continue;a.push({id:c,ct:h.value})}}if(0!==a.length){a.sort((function(t,e){return t.ct-e.ct}));for(var d=0,y=a;d<y.length;d++){g(t,i,e[y[d].id])}}}}function g(t,e,i){var n={x:0,y:0},o={value:0},s=t.xVel+t.xVelExt,r=t.yVel+t.yVelExt;if(k(t.hitbox?t.hitbox:t,i.hitbox?i.hitbox:i,s,r,e,{x:0,y:0},n,o)){var a=1.001;return t.xVel+=n.x*Math.abs(t.xVel)*(1-o.value)*a,t.yVel+=n.y*Math.abs(t.yVel)*(1-o.value)*a,t.xVelExt+=n.x*Math.abs(t.xVelExt)*(1-o.value)*a,t.yVelExt+=n.y*Math.abs(t.yVelExt)*(1-o.value)*a,!0}return!1}function k(t,e,i,n,o,s,r,a){if(0==i&&0==n)return!1;a.value=0;var h={x:e.x-t.w/2,y:e.y-t.h/2,w:e.w+t.w,h:e.h+t.h};return!!function(t,e,i,n,o,s){n.x=0,n.y=0,o.x=0,o.y=0;var r={x:1/e.x,y:1/e.y},a={x:(i.x-t.x)*r.x,y:(i.y-t.y)*r.y},h={x:(i.x+i.w-t.x)*r.x,y:(i.y+i.h-t.y)*r.y};if(isNaN(h.y)||isNaN(h.x))return!1;if(isNaN(a.y)||isNaN(a.x))return!1;if(a.x>h.x){var l=a.x;a.x=h.x,h.x=l}if(a.y>h.y){var u=a.y;a.y=h.y,h.y=u}if(a.x>h.y||a.y>h.x)return!1;if(s.value=Math.max(a.x,a.y),Math.min(h.x,h.y)<0)return!1;n.x=t.x+s.value*e.x,n.y=t.y+s.value*e.y,a.x>a.y?r.x<0?(o.x=1,o.y=0):(o.x=-1,o.y=0):a.x<a.y&&(r.y<0?(o.x=0,o.y=1):(o.x=0,o.y=-1));return!0}({x:t.x+t.w/2,y:t.y+t.h/2},{x:i*o,y:n*o},h,s,r,a)&&(a.value>=0&&a.value<1)}function A(t,e){return!(!e.removed&&e!=t)}function E(t,e){return!(e.solid&&!e.removed&&e!=t&&(!e.grounded||t.grounded))}function V(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.hitbox&&!i?t.hitbox:t,o=e.hitbox&&!i?e.hitbox:e;return n.x<o.x+o.w&&n.x+n.w>o.x&&n.y<o.y+o.h&&n.y+n.h>o.y}function P(t,e){if(null==t||null==e)return!0;var i=t.hitbox||t,n=e.hitbox||e,o=i.x+i.w/2-(n.x+n.w/2),s=i.y+i.h/2-(n.y+n.h/2),r=i.w/2+n.w/2,a=i.h/2+n.h/2,h="";if(Math.abs(o)<r&&Math.abs(s)<a){var l=r-Math.abs(o),u=a-Math.abs(s);l>=u?s>0?(h="t",t.col.T<u&&u>.01&&(t.col.T+=u)):(h="b",t.col.B<u&&u>.01&&(t.col.B+=u)):o>0?(h="l",t.col.L<l&&l>.01&&(t.col.L+=l)):(h="r",t.col.R<l&&l>.01&&(t.col.R+=l))}return h}function S(t,e){var i=[],n=[];if(1==t.length)return t;for(var o=0;o<t.length;o++)for(var s=0;s<t[o].w;s++)for(var r=0;r<t[o].h;r++){var a={x:t[o].x+s,y:t[o].y+r,w:1,h:1};M(e,a)&&n.push(a)}if(0==n.length)return[];var h,l,u={x:n[0].x,y:n[0].y,w:n[0].w,h:n[0].h};i.push(u);for(var c=0;c<n.length;c++)for(var f=0;f<i.length;f++)if(h=void 0!==n[c].hitbox?n[c].hitbox:n[c],l=i[f],h.y==l.y&&h.h==l.h)h.x+h.w>l.x+l.w&&(l.w=h.x+h.w-l.x),h.x<l.x&&(l.w+=l.x-h.x,l.x=h.x);else if(h.x==l.x&&h.w==l.w)h.y+h.h>l.y+l.h&&(l.h=h.y+h.h-l.y),h.y<l.y&&(l.h+=l.y-h.y,l.y=h.y);else{var d={x:h.x,y:h.y,w:h.w,h:h.h};i.push(d)}return i}function M(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="undefined"===typeof t.hitbox||i?t:t.hitbox,o="undefined"===typeof e.hitbox||i?e:e.hitbox;return n.x<o.x+o.w&&n.x+n.w>o.x&&n.y<o.y+o.h&&n.y+n.h>o.y}function C(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.hitbox&&!i?e.hitbox:e;return t.x>=n.x&&t.x<=n.x+n.w&&t.y>=n.y&&t.y<=n.y+n.h}function R(t,e){for(var i=T(e),n=0;n<i.length;n++)if(O(i[n].x1,i[n].y1,i[n].x2,i[n].y2,t.x1,t.y1,t.x2,t.y2))return!0;return!1}function O(t,e,i,n,o,s,r,a){if(t===i&&e===n||o===r&&s===a)return!1;var h=(a-s)*(i-t)-(r-o)*(n-e);if(0===h)return!1;var l=((r-o)*(e-s)-(a-s)*(t-o))/h,u=((i-t)*(e-s)-(n-e)*(t-o))/h;return!(l<0||l>1||u<0||u>1)&&{x:t+l*(i-t),y:e+l*(n-e)}}function T(t){var e=[],i=t;return void 0!==t.hitbox&&(i=t.hitbox),e.push({x1:i.x,y1:i.y,x2:i.x+i.w,y2:i.y}),e.push({x1:i.x+i.w,y1:i.y,x2:i.x+i.w,y2:i.y+i.h}),e.push({x1:i.x+i.w,y1:i.y+i.h,x2:i.x,y2:i.y+i.h}),e.push({x1:i.x,y1:i.y+i.h,x2:i.x,y2:i.y}),e}function L(t){var e=t.x1,i=t.y1,n=t.x2-e,o=t.y2-i;return Math.atan2(o,n)}function Y(t,e){var i=t.x,n=(t.w,t.y),o=(t.h,e.x),s=e.w,r=e.y,a=e.h,h=o+s/2-(i+s/2),l=r+a/2-(n+a/2);return Math.atan2(l,h)}function I(t){var e=L({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2});return[Math.cos(e),Math.sin(e)]}function X(t,e){return L({x1:t.x+t.w/2,y1:t.y+t.h/2,x2:e.x+e.w/2,y2:e.y+e.h/2})}function j(t,e){var i=t.w?t.x+t.w/2:t.x,n=t.h?t.y+t.h/2:t.y,o=e.w?e.x+e.w/2:e.x,s=e.h?e.y+e.h/2:e.y;return Math.sqrt(Math.pow(i-o,2)+Math.pow(n-s,2))}function z(t,e,i){return(e=o(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function W(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}var D=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#ad2f45",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"center",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"middle";a(this,t),this.content="",this.x=void 0,this.y=void 0,this.color=void 0,this.align=void 0,this.baseline=void 0,this.fontSize=7,this.font="Consolas, monaco, monospace",this.shadow=!1,this.shadowColor="#14182e",this.strokeWidth=.3,this.stroke=void 0,this.strokeColor=void 0,this.x=e,this.y=i,this.color=n,this.align=o,this.stroke=!1,this.baseline=s,this.strokeColor="#ffffff"}return r(t,[{key:"shadowOffsetX",get:function(){return this.fontSize/200}},{key:"shadowOffsetY",get:function(){return this.fontSize/200}},{key:"canvasFont",value:function(t){return"bold "+Math.round(this.fontSize*t)+"px "+this.font}},{key:"render",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0};if(this.stroke&&(t.lineWidth=this.strokeWidth*i,t.strokeStyle=this.strokeColor),t.textBaseline=this.baseline,t.textAlign=this.align,t.fillStyle=this.color,t.font=this.canvasFont(i),"string"!==typeof this.content)for(var o=0;o<this.content.length;o++)this.stroke&&t.strokeText(this.content[o],(this.x+n.x)*e*i,((this.y+n.y)*e+this.fontSize*o)*i),this.shadow&&(t.fillStyle=this.shadowColor,t.fillText(this.content[o],(this.x+n.x+this.shadowOffsetX)*e*i,((this.y+n.y+this.shadowOffsetY)*e+this.fontSize*o)*i)),t.fillStyle=this.color,t.fillText(this.content[o],(this.x+n.x)*e*i,((this.y+n.y)*e+this.fontSize*o)*i);else this.stroke&&t.strokeText(this.content,(this.x+n.x)*e*i,(this.y+n.y)*e*i),this.shadow&&(t.fillStyle=this.shadowColor,t.fillText(this.content,(this.x+n.x+this.shadowOffsetX)*e*i,(this.y+n.y+this.shadowOffsetY)*e*i)),t.fillStyle=this.color,t.fillText(this.content,(this.x+n.x)*e*i,(this.y+n.y)*e*i)}}]),t}(),H=function(t){u(i,t);var e=d(i);function i(t){var n;return a(this,i),(n=e.call(this,t.centerX,t.centerY)).source=void 0,n.type="vfx",n.name="proto",n.removed=!1,n.randomPos=!1,n.randomAmount=.5,n.source=t,n}return r(i,[{key:"resolveCollisions",value:function(){}},{key:"renderShadow",value:function(){}},{key:"randomizePos",value:function(){this.x+=Math.random()*this.randomAmount-this.randomAmount/2,this.y+=Math.random()*this.randomAmount-this.randomAmount/2}},{key:"reset",value:function(t){this.source=t,this.moveAtSource(),this.randomPos&&this.randomizePos(),this.removed=!1,this.frame=0,this.frameCounter=0,this.additionalResetOperations()}},{key:"additionalResetOperations",value:function(){}},{key:"moveAtSource",value:function(){this.x=this.source.centerX-this.w/2,this.y=this.source.centerY-this.h/2}},{key:"compute",value:function(t){this.updateSprite(t)}},{key:"render",value:function(t,e,i,n){this.renderSprite(t,e,i,n)}},{key:"onAnimationEnd",value:function(){this.removed=!0}}]),i}(v),F=function(t){u(i,t);var e=d(i);function i(t){var n;return a(this,i),(n=e.call(this,t)).name="DmgVfx",n.w=1,n.h=1,n.randomPos=!0,n.randomizePos(),n.setAnimation("boom",[17,17,17,17],[0,1,2,3]),n.setAnimation("cut",[18,18,18,18],[0,1,2,3]),n.setAnimation("cut_long",[20,20,20,20],[0,1,2,3]),n.animations.cut_long.w=2,n.additionalResetOperations(),n}return r(i,[{key:"additionalResetOperations",value:function(){var t=Object.entries(this.animations);this.animation=t[Math.random()*t.length|0][0];var e=[0,90,180,-90];this.rot=e[Math.random()*e.length|0]}}]),i}(H),B=function(t){u(i,t);var e=d(i);function i(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return a(this,i),(n=e.call(this,t.x,t.y)).verticalSpeed=-.03,n.x=void 0,n.y=void 0,n.source=void 0,n.lifeCycles=void 0,n.remainingCycles=void 0,n.setAnimation("idle",[19,19,19,19],[0,1,2,3]),n.source=t,n.lifeCycles=o,n.remainingCycles=n.lifeCycles,n.x=t.x+t.w/2+1.5*Math.random()-.75-n.w/2,n.y=t.y+t.h/2+1.5*Math.random()-.75-n.h/2,n.x-=n.w/2,n.y-=n.h/2,n}return r(i,[{key:"randomX",get:function(){return this.source.x+this.source.w/2+1.5*Math.random()-.75-this.w/2}},{key:"randomY",get:function(){return this.source.y+this.source.h/2+1.5*Math.random()-.75-this.h/2}},{key:"reset",value:function(t,e){this.source=t,this.x=this.randomX,this.y=this.randomY,this.removed=!1,this.remainingCycles=e||this.lifeCycles}},{key:"onAnimationEnd",value:function(){this.remainingCycles--,this.remainingCycles<=0?this.removed=!0:(this.x=this.randomX,this.y=this.randomY)}},{key:"compute",value:function(t){this.y+=this.verticalSpeed*t,this.updateSprite(t)}},{key:"render",value:function(t,e,i,n){this.renderSprite(t,e,i,n)}}]),i}(v),U=function(t){u(i,t);var e=d(i);function i(t){var n;return a(this,i),(n=e.call(this,t)).particlesDuration=5,n.particlesAmount=5,n.particles=[],n.name="ParticlesVfx",n.particlesDuration=5,n.particlesAmount=5,n.particles=[],n.initialize(),n}return r(i,[{key:"initialize",value:function(){for(var t=0;t<this.particlesAmount;t++)this.particles.push(new B(this.source,this.particlesDuration))}},{key:"additionalResetOperations",value:function(){var t,e=w(this.particles);try{for(e.s();!(t=e.n()).done;){t.value.reset(this.source,this.particlesDuration)}}catch(i){e.e(i)}finally{e.f()}}},{key:"compute",value:function(t){var e,i=0,n=w(this.particles);try{for(n.s();!(e=n.n()).done;){var o=e.value;o.removed?i++:o.compute(t)}}catch(s){n.e(s)}finally{n.f()}i===this.particles.length&&(this.removed=!0)}},{key:"render",value:function(t,e,i,n){var o,s=w(this.particles);try{for(s.s();!(o=s.n()).done;){var r=o.value;r.removed||r.render(t,e,i,n)}}catch(a){s.e(a)}finally{s.f()}}}]),i}(H),J=function(t){u(i,t);var e=d(i);function i(t){var n;return a(this,i),(n=e.call(this,t)).name="TextVfx",n.text=new D(0,0),n.progress=0,n.text.content="",n.text.color="#ad2f45",n.text.shadow=!0,n.text.fontSize=10,n}return r(i,[{key:"reset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.removed=!1,this.progress=0,this.text.content=e,this.source=t}},{key:"compute",value:function(t){this.progress+=Math.PI/60*t,this.progress>=Math.PI?this.removed=!0:(this.x=this.source.centerX+this.progress/10,this.y=this.source.centerY-Math.sin(this.progress),this.text.x=this.x,this.text.y=this.y)}},{key:"render",value:function(t,e,i,n){this.text.render(t,e,i,n)}}]),i}(H),N=function(){function t(){var e=this;a(this,t),this.recyclePool=[],this.environment=[],this.vfxClasses=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?W(Object(i),!0).forEach((function(e){z(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):W(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},i),this.create=function(t,i){var n=e.getRecycledVfx(t,i)||new e.vfxClasses[t](i);return e.environment.push(n),n}}return r(t,[{key:"setEnvironment",value:function(t){this.environment=t}},{key:"getRecycledVfx",value:function(t,e){for(var i=this.recyclePool.length-1;i>=0;i--)if(this.recyclePool[i].name===t)return this.recyclePool[i].reset(e),this.recyclePool.splice(i,1)[0];return!1}}]),t}(),q=new N,G=r((function t(){var e=this;a(this,t),this.playbackRate=1,this.volume=1,this.sounds={playRandom:function(t){e.sounds[t[Math.random()*t.length|0]].play()}},this.soundsBaseUrl="assets/soundFxs/",this.createSound=function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s="".concat(e.soundsBaseUrl).concat(t,".mp3"),r=t.split("/"),a=r[r.length-1];e.sounds[a]=new Q(s,i,n,o)}})),Q=r((function t(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a(this,t),this.audio=void 0,this.loop=!1,this.volume=1,this.playbackRate=1,this.calledPlayPromise=!1,this.play=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(i.calledPlayPromise)return!1;if(i.audio.volume=i.volume*t,i.audio.loop=i.loop,i.audio.playbackRate=i.playbackRate*e,i.audio.paused)i.audio.loop||(i.audio.currentTime=0);else{if(i.audio.loop)return;i.audio.pause(),i.audio.currentTime=0}var n=i.audio.play();i.calledPlayPromise=!0,void 0!==n&&n.catch((function(t){console.warn("there was an audio error!",t),i.calledPlayPromise=!1})).then((function(){i.calledPlayPromise=!1}))},this.audio=new Audio(e),this.loop=n,this.volume=o,this.playbackRate=s})),K=new G,_=function(t){u(n,t);var i=d(n);function n(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a(this,n),(t=i.call(this,o,s)).xVel=0,t.yVel=0,t.xVelExt=0,t.yVelExt=0,t.speed=.1,t.friction=0,t.type="entity",t.state="idle",t.sounds=K.sounds,t.stats=new Z,t.background=!1,t.grounded=!1,t.damaged=0,t.shadow=!1,t.solid=!0,t.removed=!1,t.immovable=!1,t.drops=[],t.offsetX=0,t.offsetY=0,t.Physics=e,t.hasHpBar=!1,t.hasDisplayName=!1,t.col={L:0,R:0,T:0,B:0},t.hitbox={x:0,y:0,w:0,h:0},t.hitboxOffset={x:0,y:0,w:0,h:0},t.createVfx=q.create,t.checkCollisions=b,t.updateHitbox(),t}return r(n,[{key:"atk",get:function(){return this.stats.atk}},{key:"hp",get:function(){return this.stats.hp},set:function(t){this.stats.hp=t}},{key:"centerX",get:function(){return this.x+this.w/2}},{key:"centerY",get:function(){return this.y+this.h/2}},{key:"centerPoint",get:function(){return{x:this.centerX,y:this.centerY}}},{key:"updateHitbox",value:function(){this.hitbox.x=this.x+this.hitboxOffset.x,this.hitbox.y=this.y+this.hitboxOffset.y,this.hitbox.w=this.w+this.hitboxOffset.w,this.hitbox.h=this.h+this.hitboxOffset.h}},{key:"onCollision",value:function(t){}},{key:"resolveCollisions",value:function(){this.col.L&&this.xVel+this.xVelExt<0&&(this.xVel=0,this.xVelExt=0),this.col.R&&this.xVel+this.xVelExt>0&&(this.xVel=0,this.xVelExt=0),this.col.T&&this.yVel+this.yVelExt<0&&(this.yVel=0,this.yVelExt=0),this.col.B&&this.yVel+this.yVelExt>0&&(this.yVel=0,this.yVelExt=0),this.col.L=0,this.col.R=0,this.col.T=0,this.col.B=0}},{key:"onHit",value:function(t){this.xVelExt=t.xVel,this.yVelExt=t.yVel}},{key:"updateVelocities",value:function(t){0!==this.xVelExt&&(this.xVelExt*=Math.pow(this.friction,t),Math.abs(this.xVelExt)<.001&&(this.xVelExt=0)),0!==this.yVelExt&&(this.yVelExt*=Math.pow(this.friction,t),Math.abs(this.yVelExt)<.001&&(this.yVelExt=0))}},{key:"updatePosition",value:function(t){this.resolveCollisions(),this.x+=(this.xVel+this.xVelExt)*t,this.y+=(this.yVel+this.yVelExt)*t}},{key:"compute",value:function(t){}},{key:"render",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:this.w/2,y:this.h/2};this.renderSprite(t,e,i,n,o)}},{key:"renderHitbox",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0};t.strokeStyle="red",t.beginPath(),t.strokeRect((this.hitbox.x+n.x)*e*i,(this.hitbox.y+n.y)*e*i,this.hitbox.w*e*i,this.hitbox.h*e*i),t.closePath(),t.stroke()}},{key:"renderShadow",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0};this.shadow&&!this.removed&&(t.fillStyle="#14182e",t.globalAlpha=.6,t.strokeStyle="#ffffff",t.beginPath(),t.ellipse((this.x+n.x+this.w/2)*e*i,(this.y+this.h+n.y)*e*i,this.w/2*e*i,this.w/4*e*i,0,0,2*Math.PI),t.closePath(),t.fill(),t.globalAlpha=1)}}]),n}(v),Z=r((function t(){a(this,t),this.lv=void 0,this.maxHp=void 0,this.hp=void 0,this.maxExp=void 0,this.exp=void 0,this.maxMana=void 0,this.mana=void 0,this.atk=void 0,this.atkSpeed=void 0,this.expValue=void 0,this.lv=1,this.maxHp=10,this.hp=this.maxHp,this.maxExp=10,this.exp=0,this.maxMana=15,this.mana=this.maxMana,this.atk=1,this.atkSpeed=1,this.expValue=1})),$=_,tt=function(){function t(){a(this,t),this.up=void 0,this.down=void 0,this.left=void 0,this.right=void 0,this.upR=void 0,this.downR=void 0,this.leftR=void 0,this.rightR=void 0,this.spacebar=void 0,this.e=void 0,this.lClickDown=void 0,this.mClickDown=void 0,this.rClickDown=void 0,this.test=void 0,this.currentPos=void 0,this.lastDir=void 0,this.mouseX=void 0,this.mouseY=void 0,this.up=!1,this.down=!1,this.left=!1,this.right=!1,this.upR=!1,this.downR=!1,this.leftR=!1,this.rightR=!1,this.spacebar=!1,this.e=!1,this.lClickDown=!1,this.mClickDown=!1,this.rClickDown=!1,this.test="test",this.currentPos=0,this.lastDir=0,this.mouseX=0,this.mouseY=0,this.initListeners()}return r(t,[{key:"initListeners",value:function(){document.addEventListener("mousedown",n),document.addEventListener("mouseup",n),document.addEventListener("touchstart",i),document.addEventListener("touchend",i),document.addEventListener("keydown",e),document.addEventListener("keyup",e);var t=this;function e(e){var i="keydown"===e.type;switch(e.key){case"w":t.up=i;break;case"s":t.down=i;break;case"a":t.left=i;break;case"d":t.right=i;break;case"ArrowUp":t.upR=i;break;case"ArrowDown":t.downR=i;break;case"ArrowLeft":t.leftR=i;break;case"ArrowRight":t.rightR=i;break;case" ":t.spacebar=i;break;case"e":t.e=i;break;case"Escape":case"y":break;default:console.log('Pressed "'.concat(e.key,'" key'))}}function i(e){console.log(e);var i="touchstart"===e.type;t.lClickDown=i,i&&(t.mouseX=e.touches[0].clientX,t.mouseY=e.touches[0].clientY)}function n(e){var i="mousedown"===e.type;switch(e.button){case 0:t.lClickDown=i;break;case 1:t.mClickDown=i;break;case 2:t.rClickDown=i}t.mouseX=e.clientX,t.mouseY=e.clientY}}}]),t}(),et=r((function t(e,i,n){var o=this;a(this,t),this.x=0,this.y=0,this.gui={x:0,y:0},this.guiRef={ratio:1},this.canvas=void 0,this.meta=void 0,this.camera=void 0,this.absolute={x:0,y:0,hoverUI:!1,dragging:!1,slot:{}},this.lastMouseX=0,this.lastMouseY=0,this.setCanvas=function(t){o.canvas=t},this.updatePos=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clientX:o.lastMouseX,clientY:o.lastMouseY};o.canvas&&(o.lastMouseX=t.clientX,o.lastMouseY=t.clientY,o.absolute.x=(t.clientX-o.canvas.offsetLeft)/o.meta.tilesize/o.meta.ratio,o.absolute.y=(t.clientY-o.canvas.offsetTop)/o.meta.tilesize/o.meta.ratio,o.x=o.absolute.x-o.camera.x,o.y=o.absolute.y-o.camera.y,o.gui.x=o.absolute.x*o.meta.ratio/o.guiRef.ratio,o.gui.y=o.absolute.y*o.meta.ratio/o.guiRef.ratio)},this.updatePosMobile=function(t){o.canvas&&0!==t.touches.length&&(o.lastMouseX=t.touches[0].clientX,o.lastMouseY=t.touches[0].clientY,o.absolute.x=(t.touches[0].clientX-o.canvas.offsetLeft)/o.meta.tilesize/o.meta.ratio,o.absolute.y=(t.touches[0].clientY-o.canvas.offsetTop)/o.meta.tilesize/o.meta.ratio,o.x=o.absolute.x-o.camera.x,o.y=o.absolute.y-o.camera.y,o.gui.x=o.absolute.x*o.meta.ratio/o.guiRef.ratio,o.gui.y=o.absolute.y*o.meta.ratio/o.guiRef.ratio)},this.canvas=e,this.meta=i,this.camera=n,document.addEventListener("mousemove",this.updatePos),document.addEventListener("touchstart",this.updatePosMobile)}));function it(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,o,s,r,a=[],h=!0,l=!1;try{if(s=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;h=!1}else for(;!(h=(n=s.call(i)).done)&&(a.push(n.value),a.length!==e);h=!0);}catch(u){l=!0,o=u}finally{try{if(!h&&null!=i.return&&(r=i.return(),Object(r)!==r))return}finally{if(l)throw o}}return a}}(t,e)||p(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var nt=r((function t(){var e=this;a(this,t),this.div=void 0,this.activateButton=void 0,this.window=void 0,this.active=void 0,this.times=void 0,this.drawLater=void 0,this.drawRect=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"red";e.active&&e.drawLater.push({color:i,type:"rect",x:t.x,y:t.y,w:t.w,h:t.h})},this.drawPoint=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"red";e.active&&e.drawLater.push({color:i,type:"point",x:t.x-.1,y:t.y-.1,w:.2,h:.2})},this.drawLine=function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"red";e.active&&e.drawLater.push({color:n,type:"line",x1:t.x,y1:t.y,x2:i.x,y2:i.y})},this.render=function(t,i,n,o){if(e.active){var s,r=w(e.drawLater);try{for(r.s();!(s=r.n()).done;){var a=s.value;switch(t.beginPath(),t.strokeStyle=a.color,a.type){case"point":case"rect":t.save(),t.translate((o.x+a.x+a.w/2)*i*n,(o.y+a.y+a.h/2)*i*n),t.rotate(o.rot),t.rect(-a.w/2*i*n,-a.h/2*i*n,a.w*i*n,a.h*i*n),t.closePath(),t.stroke(),t.restore();break;case"line":t.save(),t.translate((o.x+a.x1)*i*n,(o.y+a.y1)*i*n),t.rotate(o.rot),t.moveTo(0*i*n,0*i*n),t.lineTo((a.x2-a.x1+.5)*i*n,(a.y2-a.y1+.5)*i*n),t.closePath(),t.stroke(),t.restore()}}}catch(h){r.e(h)}finally{r.f()}e.drawLater.length=0}},this.printTime=function(){e.active&&(e.div.innerHTML="Function time: ".concat(e.averageTime().toFixed(4),"ms"),e.times.length=0)},this.inspect=function(t){e.active&&(e.div.innerHTML='<table style="color:white;">\n        '.concat(Object.entries(t).reduce((function(t,e){var i=it(e,2),n=i[0],o=i[1];return["object","function"].includes(typeof o)?t:t+"<tr><td>".concat(n,"</td><td>").concat(o,"</td></tr>")}),""),"\n      </table>\n      "))},this.measureTime=function(t){if(e.active){e.active||e.activate();for(var i=performance.now(),n=arguments.length,o=new Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];t.apply(void 0,o),e.times.push(performance.now()-i)}},this.activate=function(){e.createWindow(600,600),e.active=!0,e.activateButton.onclick=e.deactivate,e.activateButton.innerText="DEACTIVATE DEBUG"},this.deactivate=function(){e.window=null,e.active=!1,e.activateButton.onclick=e.activate,e.activateButton.innerText="ACTIVATE DEBUG"},this.averageTime=function(){var t,i=0,n=w(e.times);try{for(n.s();!(t=n.n()).done;){i+=t.value}}catch(o){n.e(o)}finally{n.f()}return i/e.times.length},this.createWindow=function(t,i){e.window=window.open("","targetWindow","noopener=false,noreferrer=false,popup,width=".concat(t,",height=").concat(i)),e.window&&(e.active=!0,e.window.document.body.style.margin="0",e.window.document.body.style.padding="0",e.window.window.document.body.style.boxSizing="border-box",e.window.window.document.body.style.backgroundColor="black",e.window.window.document.body.style.color="white",e.window.window.document.body.style.padding="10px",e.window.document.title="debugger",e.window.document.body.innerHTML="",e.window.document.body.appendChild(e.div),e.window.onbeforeunload=e.deactivate,e.window.addEventListener("keydown",(function(t){var i;"F2"===t.key&&(null===(i=e.window)||void 0===i||i.close())})))},this.createDiv=function(){var t=document.createElement("div");return t.style.position="absolute",t.style.inset="0",t.style.fontFamily='"Lucida Console", "Courier New", monospace',t},this.createActivateButton=function(){var t=document.createElement("button");return t.innerText="ACTIVATE DEBUG",t.style.position="absolute",t.style.top="20px",t.style.right="20px",t.onclick=function(){return e.activate()},window.document.body.appendChild(t),window.addEventListener("keydown",(function(e){if("F2"===e.key){var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t.dispatchEvent(i)}})),t},this.div=this.createDiv(),this.active=!1,this.times=[],this.drawLater=[],this.window=null,this.activateButton=this.createActivateButton()})),ot=new nt,st=function(t){u(i,t);var e=d(i);function i(t,n,o,s,r){var l;return a(this,i),(l=e.call(this,t,n)).controls=void 0,l.mouse=void 0,l.camera=void 0,l.resolveInputs=function(){l.controls.up&&!l.controls.down&&(l.xVel=Math.cos(-l.rot+Math.PI/2)*-l.speed,l.yVel=Math.sin(-l.rot+Math.PI/2)*-l.speed),l.controls.down&&!l.controls.up&&(l.xVel=Math.cos(-l.rot+Math.PI/2)*l.speed,l.yVel=Math.sin(-l.rot+Math.PI/2)*l.speed),l.controls.up||l.controls.down||(l.xVel=0,l.yVel=0)},l.compute=function(t){l.mouse.updatePos(),l.rot=l.Physics.getAngle({x1:l.x+l.w/2,y1:l.y+l.h/2,x2:l.mouse.x,y2:l.mouse.y})+2*Math.PI,l.resolveInputs(),l.updateVelocities(t),l.updatePosition(t),l.updateHitbox(),ot.inspect(h(l)),ot.drawPoint(l.centerPoint),ot.drawPoint(l.mouse,"green")},l.render=function(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:l.w/2,y:l.h/2},s=l.rot;l.rot=0,l.renderSquare(t,e,i,n,o),l.rot=s,t.fillStyle="red",t.fillStyle="black"},l.mouse=new et(o,s,r),l.controls=new tt,l.camera=r,l.w=1,l.h=1,l}return r(i)}(_),rt=st,at=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,w:0,h:0,rot:0};a(this,t),this.focus=void 0,this.lockedAngles=!1,this.zoom=!1,this.x=void 0,this.y=void 0,this.rot=0,this.shake=0,this.focus=e,this.x=e.x,this.y=e.y}return r(t,[{key:"changeFocus",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.focus=t,e||(this.x=-this.focus.x,this.y=-this.focus.y)}},{key:"compute",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:-1/0,y:1/0,w:1/0,h:1/0};this.rot=this.focus.rot;var i=e;i&&i.w<t.tilesWidth+1&&(i.x-=(t.tilesWidth+1-i.w)/2,i.w=t.tilesWidth+1),i&&i.h<t.tilesHeight+1&&(i.y-=(t.tilesHeight+1-i.h)/2,i.h=t.tilesHeight+1),this.zoom&&t.changeRatio(t.ratio+(t.baseRatio-t.ratio)/22*t.deltaTime);var n=0,o=0;if(this.focus&&(n=-(this.focus.x+this.focus.w/2-t.tilesWidth/2),o=-(this.focus.y+this.focus.h/2-t.tilesHeight/2),this.x+=(n-this.x)/15*t.deltaTime,this.y+=(o-this.y)/15*t.deltaTime),this.lockedAngles&&i){-this.x<i.x&&(n=-i.x,!0),-this.y<i.y&&(o=-i.y,!0),-this.x>i.x+i.w-t.tilesWidth&&(n=-(i.x+i.w-t.tilesWidth),!0),-this.y>i.y+i.h-t.tilesHeight&&(o=-(i.y+i.h-t.tilesHeight),!0)}this.shake>0&&(this.x+=Math.random()/2-.25,this.y+=Math.random()/2-.25,this.shake-=t.deltaTime)}}]),t}(),ht=at;function lt(t,e,i){return lt=f()?Reflect.construct.bind():function(t,e,i){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return i&&l(o,i.prototype),o},lt.apply(null,arguments)}function ut(t){var e="function"===typeof Map?new Map:void 0;return ut=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return lt(t,arguments,c(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,t)},ut(t)}var ct=function(t){u(i,t);var e=d(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:800,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600;return a(this,i),(t=e.call(this)).context=void 0,t.center=function(){t.style.position="absolute",t.style.left=(window.innerWidth-t.width)/2+"px",t.style.top=(window.innerHeight-t.height)/2+"px"},t.clear=function(){t.context.clearRect(0,0,t.width,t.height)},t.initialize=function(){window.addEventListener("resize",(function(){return t.center()})),t.center(),document.body.appendChild(h(t)),t.context.imageSmoothingEnabled=!1},t.oncontextmenu=function(t){t.preventDefault()},t.width=n,t.height=o,t.context=t.getContext("2d"),t.style.outline="22px inset black",t.initialize(),t}return r(i)}(ut(HTMLCanvasElement));customElements.define("game-canvas",ct,{extends:"canvas"});var ft=ct;function dt(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||p(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var yt=function(t){u(i,t);var e=d(i);function i(t,n){var o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return a(this,i),(o=e.call(this,t,n)).offset=0,o.render=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0,rot:0},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:o.w/2,y:o.h/2};o.display&&(o.removed,t.save(),t.translate((s.x+o.x+o.w/2+n.x)*e*i|0,(s.y+o.y+o.h/2+n.y)*e*i|0),t.rotate(n.rot),t.drawImage(o.sheet,o.animations[o.animation].keyframesX[o.left][o.frame]*e,o.animations[o.animation].keyframesY[o.left][o.frame]*e,o.animations[o.animation].w*e,o.animations[o.animation].h*e,-s.x*e*i|0,-s.y*e*i|0,o.animations[o.animation].w*e*i|0,o.animations[o.animation].h*e*i|0),t.restore())},o.offset=s,o}return r(i)}(v),vt=function(t){u(i,t);var e=d(i);function i(t,n){var o,s;return a(this,i),(s=e.call(this,t,n)).offSet=2,s.stacks=[],s.render=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0,rot:0},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:s.w/2,y:s.h/2};s.stacks.forEach((function(r){r.x=s.x,r.y=s.y-r.offset,r.render(t,e,i,n,o)}))},(o=s.stacks).push.apply(o,dt([0,.2,.4,.6,.8,1].map((function(t,e){var i=new yt(s.x,s.y,t);return i.setAnimation("idle",[0],[e]),i})))),s}return r(i)}($),mt=r((function t(e){var i=this;a(this,t),this.tilesize=16,this.baseRatio=2,this.ratio=this.baseRatio,this.fps=0,this.displayFps=!0,this.deltaTime=1,this.targetFrames=60,this.perfectFrameTime=1e3/this.targetFrames,this.lastTimestamp=Date.now(),this.timestamp=Date.now(),this.loopType=0,this.baseTilesWidth=window.innerWidth/this.tilesize/this.ratio,this.baseTilesHeight=window.innerHeight/this.tilesize/this.ratio,this.tilesWidth=this.baseTilesWidth,this.tilesHeight=this.baseTilesHeight,this.init=function(t){if(i.displayFps){var e=document.createElement("span");e.style.position="absolute",e.style.color="black",e.style.fontSize="25px",e.style.fontWeight="bold",e.style.fontFamily='"Lucida Console", "Courier New", monospace',e.style.left="5px",e.style.top="5px",document.body.appendChild(e),t&&(i.baseTilesWidth=t.width/i.tilesize/i.ratio,i.baseTilesHeight=t.height/i.tilesize/i.ratio,i.tilesWidth=i.baseTilesWidth,i.tilesHeight=i.baseTilesHeight),setInterval((function(){i.fpsCounter(e)}),1e3)}},this.changeRatio=function(t){i.ratio=t,i.tilesWidth=window.innerWidth/i.tilesize/i.ratio,i.tilesHeight=window.innerHeight/i.tilesize/i.ratio},this.changeBaseRatio=function(t){i.baseRatio=t,i.baseTilesWidth=window.innerWidth/i.tilesize/i.ratio,i.baseTilesHeight=window.innerHeight/i.tilesize/i.ratio},this.compute=function(){i.fps+=1,i.updateDeltaTime()},this.updateDeltaTime=function(){i.lastTimestamp=i.timestamp,i.timestamp=Date.now(),i.deltaTime=(i.timestamp-i.lastTimestamp)/i.perfectFrameTime,i.deltaTime>2&&(i.deltaTime=2)},this.fpsCounter=function(t){t.innerHTML=String(i.fps),i.fps=0},this.init(e)})),xt=mt,pt=new ft,wt=new xt(pt);window.meta=wt;var bt=new ht,gt=new rt(pt.width/2/wt.tilesize/wt.ratio,pt.height/2/wt.tilesize/wt.ratio,pt,wt,bt);bt.focus=gt;var kt=function(){Et()},At=[gt,new vt(5,2),new vt(15,22),new vt(1,8),new vt(7,20),new vt(3,8),new vt(9,9),new vt(2,5),new vt(16,8),new vt(14,3),new vt(18,12)],Et=function t(){wt.compute(),pt.clear();for(var e=0,i=At;e<i.length;e++){i[e].compute(wt.deltaTime,At)}bt.compute(wt),ot.render(pt.context,wt.tilesize,wt.ratio,bt);for(var n=gt.centerPoint,o=0,s=At;o<s.length;o++){var r=s[o],a=r.centerPoint,h=L({x1:n.x,y1:n.y,x2:a.x,y2:a.y}),l=-j(n,a),u={x:Math.cos(h)*l,y:Math.sin(h)*l};r!==gt&&ot.drawLine(n,a),r.render(pt.context,wt.tilesize,wt.ratio,bt,r!==gt?u:void 0)}requestAnimationFrame(t)};kt(),console.log("Ready")}();
//# sourceMappingURL=main.0176b27d.js.map